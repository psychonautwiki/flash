var d=["https://metrics.psychonautwiki.org/sdk/web/countly.min.js"];function e(){return caches.keys().then(function(a){return Promise.all(a.map(function(a){return"pw-apx-2"!==a&&caches["delete"](a)["catch"](function(){})}))})["catch"](function(){})}function f(){return caches.open("pw-apx-2").then(function(a){return a.addAll(d)})}self.addEventListener("install",function(a){a.waitUntil(e().then(f).then(function(){return self.skipWaiting()}))});self.addEventListener("activate",function(a){a.waitUntil(self.clients.claim())});
function g(a){this.a=a;this.c=function(){};this.b=h(this);a.waitUntil(this.b.g);"GET"!==this.a.request.method?(k(this,/\/w\/index.php\?|\/wiki\/Special:(.*?)$/)&&l(),this.a.respondWith(fetch(this.a.request))):k(this,/^https?:\/\/h.psychonautwiki|\/metrics\/i/)?(this.end(200,"OK"),this.a.waitUntil(fetch(this.a.request))):!k(this,/^https?:\/\/(h.)?psychonaut(.wiki|wiki\.org|.(.*?).fastly.net)/)&&!k(this,/^https?:\/\/cdn.ravenjs.com/)||k(this,/\/katharsis\.json$/)?this.a.respondWith(fetch(this.a.request)):
k(this,/mobileaction\=toggle_view_(mobile|desktop)|\/w\/inde\.php\?title\=Special\:UserLogout/)?l().then(m(this)):this.a.respondWith(m(this))}function h(a){var b={},c=new Promise(function(c,n){b.resolve=c;b.reject=n;b.f=function(){b.resolve();return a.c()};b.release=function(){b.resolve(a.c())}});b.g=c;return b}function k(a,b){var c=a.a.request&&a.a.request.url||!1;return c?b.test(c):!1}
function l(){return caches.open("pw-apx-2").then(function(a){return a.keys().then(function(b){return Promise.all(b.filter(function(a){return/\/wiki\/(.*?)$/.test(a.url)}).map(function(b){return a["delete"](b)}))})})}function m(a){a.c=function(){return p(a.a.request)};return q(a.a.request).then(function(b){return b?(a.b.release(),b):a.b.f()})}g.prototype.end=function(a,b){this.a.respondWith(new Response(b||"",{status:a}))};
function q(a){return caches.open("pw-apx-2").then(function(b){return b.match(a)})}function p(a){return caches.open("pw-apx-2").then(function(b){return fetch(a).then(function(c){return b.put(a,c.clone())["catch"](function(){return c}).then(function(){return c})})})}self.addEventListener("fetch",function(a){new g(a)});
